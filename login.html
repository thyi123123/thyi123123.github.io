<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Firebase Login & Register</title>
    <script src="https://www.gstatic.com/firebasejs/10.0.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.0.0/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.0.0/firebase-firestore.js"></script>
    <style>
        body { font-family: Arial, sans-serif; background-color: #f4f4f4; text-align: center; padding: 50px; }
        .container { background: white; padding: 20px; border-radius: 5px; display: inline-block; box-shadow: 0px 0px 10px rgba(0, 0, 0, 0.1); }
        .input-field { width: 90%; padding: 10px; margin: 5px; }
        .btn { padding: 10px 20px; background-color: #35424a; color: white; border: none; cursor: pointer; margin-top: 10px; }
        .btn:hover { background-color: #5a6d73; }
    </style>
</head>
<body>

<div class="container">
    <h2>Login / Register</h2>
    <input type="text" id="email" class="input-field" placeholder="Email">
    <input type="password" id="password" class="input-field" placeholder="Password">
    <button class="btn" onclick="register()">Register</button>
    <button class="btn" onclick="login()">Login</button>
</div>

<script>
    // ðŸ”¹ Firebase Configuration
    const firebaseConfig = {
        apiKey: "AIzaSyAfxPCp_fYoqZzBgET1Rm2Cf1Hisxld8Qw",
        authDomain: "phonesite-6ac9c.firebaseapp.com",
        projectId: "phonesite-6ac9c",
        storageBucket: "phonesite-6ac9c.appspot.com",
        messagingSenderId: "YOUR_MESSAGING_SENDER_ID",
        appId: "YOUR_APP_ID"
    };

    // ðŸ”¹ Initialize Firebase
    firebase.initializeApp(firebaseConfig);
    const auth = firebase.auth();
    const db = firebase.firestore();

    // ðŸ”¹ Register User
    function register() {
        let email = document.getElementById("email").value.trim();
        let password = document.getElementById("password").value.trim();

        if (!email || !password) {
            alert("Please enter valid email and password");
            return;
        }

        auth.createUserWithEmailAndPassword(email, password)
            .then(userCredential => {
                let user = userCredential.user;
                db.collection("users").doc(user.uid).set({
                    email: user.email,
                    role: "user" // Default role
                });
                alert("Registration successful!");
            })
            .catch(error => {
                alert("Error: " + error.message);
            });
    }

    // ðŸ”¹ Login User
    function login() {
        let email = document.getElementById("email").value.trim();
        let password = document.getElementById("password").value.trim();

        auth.signInWithEmailAndPassword(email, password)
            .then(userCredential => {
                let user = userCredential.user;

                // Check role from Firestore
                db.collection("users").doc(user.uid).get().then(doc => {
                    if (doc.exists) {
                        let role = doc.data().role;
                        alert("Login successful!");
                        window.location.href = (role === "admin") ? "admin.html" : "index.html";
                    } else {
                        alert("User data not found!");
                    }
                });
            })
            .catch(error => {
                alert("Error: " + error.message);
            });
    }
</script>

</body>
</html>
